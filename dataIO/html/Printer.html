
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Printer</title><meta name="generator" content="MATLAB 7.13"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-05-20"><meta name="DC.source" content="Printer.m"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><pre class="codeinput"><span class="comment">% Printer - Class used for printing output files on screen and files.</span>
<span class="comment">%</span>
<span class="comment">% Printer Methods:</span>
<span class="comment">%    Printer - Main Constructor</span>
<span class="comment">%    CreateCytoscapeData - Create input files for Cytoscape software</span>
<span class="comment">%</span>
<span class="comment">% See also:</span>
<span class="comment">%    Reading</span>
<span class="keyword">classdef</span> Printer &lt; handle

    <span class="keyword">properties</span>

        bipweb = {};

    <span class="keyword">end</span>

    <span class="keyword">methods</span>

        <span class="keyword">function</span> obj = Printer(webbip)
        <span class="comment">% PRINTER - Main Constructor</span>
        <span class="comment">%   pt = Printer(webbip) Create a Printer object pt wich will be</span>
        <span class="comment">%   related to Bipartite object webbip.</span>

            obj.bipweb = webbip;

        <span class="keyword">end</span>

<span class="comment">%         function obj = SpeciesLevel(obj, toscreen, tofile)</span>
<span class="comment">%</span>
<span class="comment">%             webbip = obj.bipweb;</span>
<span class="comment">%</span>
<span class="comment">%             aindex = webbip.name==' ';</span>
<span class="comment">%             namebip = webbip.name;</span>
<span class="comment">%             namebip(aindex) = '_';</span>
<span class="comment">%</span>
<span class="comment">%             if(nargin == 1)</span>
<span class="comment">%                 toscreen = 1;</span>
<span class="comment">%                 tofile = 1;</span>
<span class="comment">%                 filename = [namebip, '_sp.txt'];</span>
<span class="comment">%             elseif(nargin == 2)</span>
<span class="comment">%                 tofile = 1;</span>
<span class="comment">%                 filename = [namebip, '_sp.txt'];</span>
<span class="comment">%             elseif (nargin == 3)</span>
<span class="comment">%                 filename = [namebip, '_sp.txt'];</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             header = '';</span>
<span class="comment">%             colwitdth = 9;</span>
<span class="comment">%             formatstring = ['%-',num2str(colwitdth),'s'];</span>
<span class="comment">%             formatint = ['%-',num2str(colwitdth),'d'];</span>
<span class="comment">%             formatfloat = ['%-',num2str(colwitdth),'.3f'];</span>
<span class="comment">%             estring = '----';</span>
<span class="comment">%</span>
<span class="comment">%             header = [header, sprintf(repmat(formatstring,1,6), 'Specie','Level','Degree','SPE','SSI','RR')];</span>
<span class="comment">%             if(webbip.modules.done); header = [header, sprintf(repmat(formatstring,1,1), 'Module')]; end;</span>
<span class="comment">%             header = [header, '\n'];</span>
<span class="comment">%</span>
<span class="comment">%             info = '';</span>
<span class="comment">%             for i = 1:webbip.n_rows</span>
<span class="comment">%                 aindex = webbip.row_labels{i}==' ';</span>
<span class="comment">%                 label_name = webbip.row_labels{i};</span>
<span class="comment">%                 label_name(aindex) = '_';</span>
<span class="comment">%                 info = [info, sprintf(formatstring,label_name(1:min(colwitdth,length(label_name))))];</span>
<span class="comment">%                 info = [info, sprintf(formatstring, 'top')];</span>
<span class="comment">%                 info = [info, sprintf(formatint, webbip.row_degrees(i))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.specificity(i))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.ssi(i))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.rr(i))];</span>
<span class="comment">%                 if(webbip.modules.done); info = [info, sprintf(formatint, webbip.modules.row_modules(i))]; end;</span>
<span class="comment">%                 info = [info, '\n'];</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             for i = 1:webbip.n_cols</span>
<span class="comment">%                 aindex = webbip.col_labels{i}==' ';</span>
<span class="comment">%                 label_name = webbip.col_labels{i};</span>
<span class="comment">%                 label_name(aindex) = '_';</span>
<span class="comment">%                 info = [info, sprintf(formatstring,label_name(1:min(colwitdth,length(label_name))))];</span>
<span class="comment">%                 info = [info, sprintf(formatstring, 'bottom')];</span>
<span class="comment">%                 info = [info, sprintf(formatint, webbip.col_degrees(i))];</span>
<span class="comment">%                 info = [info, sprintf(repmat(formatstring,1,3),estring,estring,estring)];</span>
<span class="comment">%                 if(webbip.modules.done); info = [info, sprintf(formatint, webbip.modules.col_modules(i))]; end;</span>
<span class="comment">%                 info = [info, '\n'];</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             if(toscreen)</span>
<span class="comment">%                 fprintf(header);</span>
<span class="comment">%                 fprintf(info);</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             if(tofile)</span>
<span class="comment">%                 fid = fopen([namebip,'-sp.txt'],'w');</span>
<span class="comment">%                 fprintf(fid,header);</span>
<span class="comment">%                 fprintf(fid,info);</span>
<span class="comment">%                 fclose(fid);</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%         end</span>
<span class="comment">%</span>
<span class="comment">%         function obj = NetworkLevelSingle(obj, toscreen, tofile, filename)</span>
<span class="comment">%             To complete, maybe have to delete at the end of the day</span>
<span class="comment">%             webbip = obj.bipweb;</span>
<span class="comment">%</span>
<span class="comment">%             if(nargin == 1)</span>
<span class="comment">%                 toscreen = 1;</span>
<span class="comment">%                 tofile = 1;</span>
<span class="comment">%                 filename = [webbip.name, '_networklevel.txt'];</span>
<span class="comment">%             elseif(nargin == 2)</span>
<span class="comment">%                 tofile = 1;</span>
<span class="comment">%                 filename = [webbip.name, '_networklevel.txt'];</span>
<span class="comment">%             elseif (nargin == 3)</span>
<span class="comment">%                 filename = [webbip.name, '_networklevel.txt'];</span>
<span class="comment">%             end</span>
<span class="comment">%             format = '%5.2f';</span>
<span class="comment">%             formatint = '%5d';</span>
<span class="comment">%             fileexist = exist(filename,'file');</span>
<span class="comment">%             header = '';</span>
<span class="comment">%             if(~fileexist)</span>
<span class="comment">%                 header = [header, '\nGeneral properties\n'];</span>
<span class="comment">%                 header = [header,   '------------------\n'];</span>
<span class="comment">%                 header = [header, '\tNetwork Name:      ', webbip.name,'\n'];</span>
<span class="comment">%                 header = [header, '\tRows:              ', num2str(webbip.n_rows,formatint),'\n'];</span>
<span class="comment">%                 header = [header, '\tCols:              ', num2str(webbip.n_cols,formatint),'\n'];</span>
<span class="comment">%                 header = [header, '\tSize:              ', num2str(webbip.size_webmatrix,formatint),'\n'];</span>
<span class="comment">%                 header = [header, '\tInteractions:      ', num2str(webbip.num_edges,formatint),'\n'];</span>
<span class="comment">%                 header = [header, '\tConnectance:       ', num2str(webbip.connectance,format),'\n'];</span>
<span class="comment">%                 header = [header, '\t&lt;Specificity&gt;:     ', num2str(mean(webbip.specificity),format),'\n'];</span>
<span class="comment">%                 header = [header, '\t&lt;Res. Range.&gt;:     ', num2str(mean(webbip.rr),format),'\n'];</span>
<span class="comment">%                 header = [header, '\tNODF:              ', num2str(webbip.nestedness.nodf,format),'\n'];</span>
<span class="comment">%                 header = [header, '\tNODF Rows:         ', num2str(webbip.nestedness.nodf_rows,format),'\n'];</span>
<span class="comment">%                 header = [header, '\tNODF Cols:         ', num2str(webbip.nestedness.nodf_cols,format),'\n'];</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             if(toscreen)</span>
<span class="comment">%                 fprintf(header);</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%         end</span>
<span class="comment">%</span>
<span class="comment">%         function obj = NetworkLevel(obj, toscreen, tofile)</span>
<span class="comment">%             webbip = obj.bipweb;</span>
<span class="comment">%             filename = './networklevel.txt';</span>
<span class="comment">%</span>
<span class="comment">%             if(nargin == 1)</span>
<span class="comment">%                 toscreen = 1;</span>
<span class="comment">%                 tofile = 1;</span>
<span class="comment">%             else(nargin == 2)</span>
<span class="comment">%                 tofile = 1;</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             header = '';</span>
<span class="comment">%             colwitdth = 9;</span>
<span class="comment">%             formatstring = ['%-',num2str(colwitdth),'s'];</span>
<span class="comment">%             formatint = ['%-',num2str(colwitdth),'d'];</span>
<span class="comment">%             formatfloat = ['%-',num2str(colwitdth),'.3f'];</span>
<span class="comment">%             estring = '----';</span>
<span class="comment">%</span>
<span class="comment">%             header = [header, sprintf(repmat(formatstring,1,5), 'Name','Conn','Size','n_rows','n_cols')];</span>
<span class="comment">%             header = [header, sprintf(repmat(formatstring,1,5), 'nodf','nodf_r','nodf_c','aspe','arr')];</span>
<span class="comment">%             header = [header, sprintf(repmat(formatstring,1,5), 'resp','inc','mN','mQb','mQr')];</span>
<span class="comment">%             header = [header, sprintf(repmat(formatstring,1,6), 'n_sim','n_pval','nicLow','nicUp','n_z','nco_sim')];</span>
<span class="comment">%             header = [header, sprintf(repmat(formatstring,1,5), 'nco_pval','ncoicLow','ncoicUp','nco_z','nro_sim')];</span>
<span class="comment">%             header = [header, sprintf(repmat(formatstring,1,4), 'nro_pval','nroicLow','nroicUp','nro_z')];</span>
<span class="comment">%             header = [header, sprintf(repmat(formatstring,1,4), 'mQr_sim','mQr_val','mQrIclow','mQrIcup','mQr_z')];</span>
<span class="comment">%             header = [header, sprintf(repmat(formatstring,1,4), 'mQb_sim','mQb_val','mQbIclow','mQbIcup','mQb_z')];</span>
<span class="comment">%             header = [header, sprintf(repmat(formatstring,1,3), 'tReps','null_name')];</span>
<span class="comment">%             header = [header, '\n'];</span>
<span class="comment">%             header = [header, '-----------------------------------------------------------------\n'];</span>
<span class="comment">%</span>
<span class="comment">%             [R I] = SpeFunc.IR(webbip.webmatrix);</span>
<span class="comment">%             aindex = webbip.name==' ';</span>
<span class="comment">%             namebip = webbip.name;</span>
<span class="comment">%             namebip(aindex) = '_';</span>
<span class="comment">%             info = sprintf(formatstring,namebip(1:min(colwitdth-1,length(namebip))));</span>
<span class="comment">%             info = [info, sprintf(formatfloat, webbip.connectance)];</span>
<span class="comment">%             info = [info, sprintf(formatint, webbip.size_webmatrix)];</span>
<span class="comment">%             info = [info, sprintf(formatint, webbip.n_rows)];</span>
<span class="comment">%             info = [info, sprintf(formatint, webbip.n_cols)];</span>
<span class="comment">%             info = [info, sprintf(formatfloat, webbip.nestedness.nodf)];</span>
<span class="comment">%             info = [info, sprintf(formatfloat, webbip.nestedness.nodf_rows)];</span>
<span class="comment">%             info = [info, sprintf(formatfloat, webbip.nestedness.nodf_cols)];</span>
<span class="comment">%             info = [info, sprintf(formatfloat, mean(webbip.specificity))];</span>
<span class="comment">%             info = [info, sprintf(formatfloat, mean(webbip.rr))];</span>
<span class="comment">%             info = [info, sprintf(formatfloat, R)];</span>
<span class="comment">%             info = [info, sprintf(formatfloat, I)];</span>
<span class="comment">%</span>
<span class="comment">%             if(webbip.modules.done)</span>
<span class="comment">%                 info = [info, sprintf(formatint, webbip.modules.N)];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.modules.Qb)];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.modules.Qr)];</span>
<span class="comment">%             else</span>
<span class="comment">%                 info = [info, sprintf(repmat(formatstring,1,3),estring,estring,estring)];</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             if(webbip.tests.nest_done)</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals.ci(1))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals.p)];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals.ci(2))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals.ci(3))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals.zscore)];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_cols.ci(1))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_cols.p)];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_cols.ci(2))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_cols.ci(3))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_cols.zscore)];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_rows.ci(1))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_rows.p)];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_rows.ci(2))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_rows.ci(3))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_rows.zscore)];</span>
<span class="comment">%             else</span>
<span class="comment">%                 info = [info, sprintf(repmat(formatstring,1,12),estring,estring,estring,estring,estring,estring, ...</span>
<span class="comment">%                     estring,estring,estring,estring,estring,estring)];</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             if(webbip.tests.modul_done)</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.qr_vals.ci(1))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.qr_vals.p)];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.qr_vals.ci(2))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.qr_vals.ci(3))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.qr_vals.zscore)];</span>
<span class="comment">%</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.qb_vals.ci(1))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.qb_vals.p)];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.qb_vals.ci(2))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.qb_vals.ci(3))];</span>
<span class="comment">%                 info = [info, sprintf(formatfloat, webbip.tests.qb_vals.zscore)];</span>
<span class="comment">%             else</span>
<span class="comment">%                 info = [info, sprintf(repmat(formatstring,1,8),estring,estring,estring, ...</span>
<span class="comment">%                     estring,estring,estring,estring,estring)];</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             if(webbip.tests.modul_done || webbip.tests.nest_done)</span>
<span class="comment">%                 info = [info, sprintf(formatint, webbip.tests.replicates)];</span>
<span class="comment">%                 info = [info, sprintf(formatstring, func2str(webbip.tests.model))];</span>
<span class="comment">%             else</span>
<span class="comment">%                 info = [info, sprintf(repmat(formatstring,1,2),estring,estring)];</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             info = [info, '\n'];</span>
<span class="comment">%</span>
<span class="comment">%             if(toscreen)</span>
<span class="comment">%                 fprintf(header);</span>
<span class="comment">%                 fprintf(info);</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             if(tofile)</span>
<span class="comment">%                 if(~exist(filename,'file'))</span>
<span class="comment">%                     fid = fopen(filename,'w');</span>
<span class="comment">%                     fprintf(fid, header);</span>
<span class="comment">%                 else</span>
<span class="comment">%                     fid = fopen(filename,'a');</span>
<span class="comment">%                 end</span>
<span class="comment">%                 fprintf(fid,info);</span>
<span class="comment">%                 fclose(fid);</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%         end</span>

        <span class="keyword">function</span> obj = CreateCytoscapeData(obj,filename)
        <span class="comment">% CreateCytoscapeData - Create input files for Cytoscape software</span>
        <span class="comment">%   obj = CreateCytoscapeData(obj,filename) Create two input files</span>
        <span class="comment">%   filename_edges.csv and filename_nodes.csv for Cytoscape</span>
        <span class="comment">%   software. The first one is indispensable for Cytoscape and</span>
        <span class="comment">%   contains the list of edges of the bipartite network. The second</span>
        <span class="comment">%   contain additional information of the nodes such as module id,</span>
        <span class="comment">%   name label, etc. This additional information can be used in</span>
        <span class="comment">%   Cytoscape for creating layouts with more information.</span>

            n_rows = obj.bipweb.n_rows;
            n_cols = obj.bipweb.n_cols;

            inter = sum(sum(obj.bipweb.adjacency));
            adlist = zeros(inter,3);

            matrix = obj.bipweb.webmatrix;

            nn = 1;

            fidedges = fopen([filename,<span class="string">'_edges.csv'</span>],<span class="string">'w'</span>);
            fidnodes = fopen([filename,<span class="string">'_nodes.csv'</span>],<span class="string">'w'</span>);

            <span class="keyword">for</span> i = 1:n_rows; fprintf(fidedges,<span class="string">'%i\n'</span>,i); <span class="keyword">end</span>;
            <span class="keyword">for</span> j = 1:n_cols; fprintf(fidedges,<span class="string">'%i\n'</span>,j+n_cols); <span class="keyword">end</span>;

            modules_done = obj.bipweb.modules.done;

            row_modul = mod(find(obj.bipweb.modules.rr'==1),obj.bipweb.modules.N);
            col_modul = mod(find(obj.bipweb.modules.tt'==1),obj.bipweb.modules.N);
            row_modul = row_modul.*(row_modul&gt;0)+(row_modul==0).*obj.bipweb.modules.N;
            col_modul = col_modul.*(col_modul&gt;0)+(col_modul==0).*obj.bipweb.modules.N;

            <span class="keyword">for</span> i = 1:n_rows
                <span class="keyword">for</span> j = 1:n_cols
                    <span class="keyword">if</span>(matrix(i,j) &gt; 0)
                        <span class="keyword">if</span>(~modules_done)
                            fprintf(fidedges,<span class="string">'%i %i %i\n'</span>,i,j+n_rows,matrix(i,j));
                        <span class="keyword">else</span>
                            <span class="keyword">if</span>(row_modul(i)==col_modul(j))
                                fprintf(fidedges,<span class="string">'%i %i %i %i\n'</span>,i,j+n_rows,matrix(i,j),row_modul(i));
                            <span class="keyword">else</span>
                                fprintf(fidedges,<span class="string">'%i %i %i %i\n'</span>,i,j+n_rows,matrix(i,j),0);
                            <span class="keyword">end</span>
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            fclose(fidedges);

            fprintf(fidnodes,<span class="string">'ID,NAME,TYPE,MODULE\n'</span>);
            row_labels = obj.bipweb.row_labels;
            col_labels = obj.bipweb.col_labels;

            <span class="keyword">for</span> i = 1:n_rows
                fprintf(fidnodes,<span class="string">'%i,%s,%i,%i\n'</span>,i,row_labels{i},1,row_modul(i));
            <span class="keyword">end</span>
            <span class="keyword">for</span> j = 1:n_cols
                fprintf(fidnodes,<span class="string">'%i,%s,%i,%i\n'</span>,j+n_rows,col_labels{j},2,col_modul(j));
            <span class="keyword">end</span>

            fclose(fidnodes);
<span class="comment">%</span>
<span class="comment">%             for j = 1:n_cols</span>
<span class="comment">%                 fprintf(fidnodes,'%i %i 2\n',j+n_rows,find(tt_final{cid}(j,:)));</span>
<span class="comment">%             end</span>
<span class="comment">%</span>
<span class="comment">%             for i = 1:nrows</span>
<span class="comment">%                 for j = 1:n_cols</span>
<span class="comment">%                     if(matrix(i,j) &gt; 0)</span>
<span class="comment">%                         adlist(nn,:) = [i matrix(i,j) (j+nrows)];</span>
<span class="comment">%                         nn = nn+1;</span>
<span class="comment">%                     end</span>
<span class="comment">%                 end</span>
<span class="comment">%             end</span>

            <span class="comment">%dlmwrite([filename,'.sif'], adlist, 'delimiter', ' ', 'precision', 6);</span>
            <span class="comment">%nodeatribs = fopen([filename,'.pvals'],'w');</span>
            <span class="comment">%fprintf(nodeatribs,'ID\tDEGREE\tTYPE\n');</span>
            <span class="comment">%for i = 1:obj.nRows</span>
            <span class="comment">%    fprintf(nodeatribs,'%i\t%i\t%i\n',i,sum(obj.Matrix(i,:)), 1);</span>
            <span class="comment">%end</span>
            <span class="comment">%for i = 1:obj.nCols</span>
            <span class="comment">%    fprintf(nodeatribs,'%i\t%i\t%i\n',i+obj.nRows,sum(obj.Matrix(:,i)), 2);</span>
            <span class="comment">%end</span>
        <span class="keyword">end</span>

        <span class="keyword">function</span> PrintBasicResults(obj)
            fprintf(<span class="string">'Modularity: '</span>);
        <span class="keyword">end</span>


    <span class="keyword">end</span>

    <span class="keyword">methods</span>

        <span class="keyword">function</span> PrintGeneralProperties(obj,filename)

            str = <span class="string">'General Properties\n'</span>;
            str = [str, <span class="string">'\t Number of species:       \t'</span>, sprintf(<span class="string">'%6i'</span>,obj.bipweb.n_rows+obj.bipweb.n_cols), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Number of row species:   \t'</span>, sprintf(<span class="string">'%6i'</span>,obj.bipweb.n_rows), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Number of column species:\t'</span>, sprintf(<span class="string">'%6i'</span>,obj.bipweb.n_cols), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Number of Interactions:  \t'</span>, sprintf(<span class="string">'%6i'</span>,obj.bipweb.num_edges), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Size:                    \t'</span>, sprintf(<span class="string">'%6i'</span>,obj.bipweb.size_webmatrix), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Connectance or fill:     \t'</span>, sprintf(<span class="string">'%6.3f'</span>,obj.bipweb.connectance), <span class="string">'\n'</span>];

            fprintf(str);

        <span class="keyword">end</span>

        <span class="keyword">function</span> PrintStructureValues(obj,filename)

            <span class="keyword">if</span>(obj.bipweb.modules.done == 0)
                obj.bipweb.modules.Detect();
            <span class="keyword">end</span>

            <span class="keyword">if</span>(obj.bipweb.ntc.done == 0)
                obj.bipweb.ntc.CalculateNestedness;
            <span class="keyword">end</span>

            str = <span class="string">'Modularity\n'</span>;
            str = [str, <span class="string">'\t Used algorithm:             \t'</span>, sprintf(<span class="string">'%16s'</span>,class(obj.bipweb.modules)), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t N (Number of modules):      \t'</span>, sprintf(<span class="string">'%16i'</span>,obj.bipweb.modules.N), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Qb (Standard metric):       \t'</span>, sprintf(<span class="string">'%16.4f'</span>,obj.bipweb.modules.Qb), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Qr (Ratio of int/ext inter):\t'</span>, sprintf(<span class="string">'%16.4f'</span>,obj.bipweb.modules.Qr), <span class="string">'\n'</span>];

            str = [str, <span class="string">'Nestedness\n'</span>];
            str = [str, <span class="string">'\tNODF metric value:           \t'</span>, sprintf(<span class="string">'%16.4f'</span>,obj.bipweb.nodf.nodf), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\tNTC metric value:            \t'</span>, sprintf(<span class="string">'%16.4f'</span>,obj.bipweb.ntc.N), <span class="string">'\n'</span>];

            fprintf(str);

        <span class="keyword">end</span>

        <span class="keyword">function</span> PrintStructureStatistics(obj,filename)

            <span class="keyword">if</span>(obj.bipweb.tests.modul_done == 0)
                obj.bipweb.tests.Modularity();
            <span class="keyword">end</span>

            <span class="keyword">if</span>(obj.bipweb.tests.nest_done == 0)
                obj.bipweb.tests.Nestedness();
            <span class="keyword">end</span>

            <span class="keyword">if</span>(obj.bipweb.tests.temp_done == 0)
                obj.bipweb.tests.Temperature();
            <span class="keyword">end</span>

            str = <span class="string">'Modularity\n'</span>;
            str = [str, <span class="string">'\t Used algorithm:\t'</span>, sprintf(<span class="string">'%30s'</span>,obj.bipweb.tests.qb_vals.algorithm), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Null model:    \t'</span>, sprintf(<span class="string">'%30s'</span>,func2str(obj.bipweb.tests.qb_vals.model)), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Replicates:    \t'</span>, sprintf(<span class="string">'%30i'</span>,obj.bipweb.tests.qb_vals.replicates), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Qb value:      \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.qb_vals.value), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t z-score:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.qb_vals.zscore), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t percent:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.qb_vals.percent), <span class="string">'\n'</span>];

            str = [str, <span class="string">'NODF Nestedness\n'</span>];
            str = [str, <span class="string">'\t Null model:    \t'</span>, sprintf(<span class="string">'%30s'</span>,func2str(obj.bipweb.tests.nestvals.model)), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Replicates:    \t'</span>, sprintf(<span class="string">'%30i'</span>,obj.bipweb.tests.nestvals.replicates), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t NODF value:    \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.nestvals.value), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t z-score:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.nestvals.zscore), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t percent:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.nestvals.percent), <span class="string">'\n'</span>];

            str = [str, <span class="string">'NTC Nestedness\n'</span>];
            str = [str, <span class="string">'\t Null model:    \t'</span>, sprintf(<span class="string">'%30s'</span>,func2str(obj.bipweb.tests.tempvals.model)), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Replicates:    \t'</span>, sprintf(<span class="string">'%30i'</span>,obj.bipweb.tests.tempvals.replicates), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t NODF value:    \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.tempvals.value), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t z-score:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.tempvals.zscore), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t percent:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.tempvals.percent), <span class="string">'\n'</span>];

            fprintf(str);

        <span class="keyword">end</span>

        <span class="keyword">function</span> PrintStructureStatisticsOfModules(obj,filename)

            <span class="keyword">if</span>(obj.bipweb.tests.modul_done == 0)
                obj.bipweb.tests.Modularity();
            <span class="keyword">end</span>

            <span class="keyword">if</span>(obj.bipweb.tests.nest_done == 0)
                obj.bipweb.tests.Nestedness();
            <span class="keyword">end</span>

            <span class="keyword">if</span>(obj.bipweb.tests.temp_done == 0)
                obj.bipweb.tests.Temperature();
            <span class="keyword">end</span>

            <span class="comment">%             fprintf('Module \t Modularity \t zscore \t percent \t NODF \t zscore \t percent \t NTC \t zscore \t percet \n');</span>
<span class="comment">%             for net = obj.module_networks</span>
<span class="comment">%                 if(isempty(net{1}.webmatrix))</span>
<span class="comment">%                     continue;</span>
<span class="comment">%                 end</span>
<span class="comment">%                 fprintf('%i \t %f \t %f \t %f \t %f \t %f \t %f \t %f \t %f \t %f \n', ...</span>
<span class="comment">%                 i, ...</span>
<span class="comment">%                 net{1}.tests.qb_vals.Qb, net{1}.tests.qb_vals.zscore, net{1}.tests.qb_vals.percent, ...</span>
<span class="comment">%                 net{1}.tests.nestvals.nodf, net{1}.tests.nestvals.zscore, net{1}.tests.nestvals.percent, ...</span>
<span class="comment">%                 net{1}.tests.tempvals.ntc, net{1}.tests.tempvals.zscore, net{1}.tests.tempvals.percent);</span>
<span class="comment">%</span>
<span class="comment">%                 i = i+1;</span>
<span class="comment">%             end</span>

            str = <span class="string">'Modularity\n'</span>;
            str = [str, <span class="string">'\t Used algorithm:\t'</span>, sprintf(<span class="string">'%30s'</span>,obj.bipweb.tests.qb_vals.algorithm), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Null model:    \t'</span>, sprintf(<span class="string">'%30s'</span>,func2str(obj.bipweb.tests.qb_vals.model)), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Replicates:    \t'</span>, sprintf(<span class="string">'%30i'</span>,obj.bipweb.tests.qb_vals.replicates), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Qb value:      \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.qb_vals.value), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t z-score:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.qb_vals.zscore), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t percent:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.qb_vals.percent), <span class="string">'\n'</span>];

            str = [str, <span class="string">'NODF Nestedness\n'</span>];
            str = [str, <span class="string">'\t Null model:    \t'</span>, sprintf(<span class="string">'%30s'</span>,func2str(obj.bipweb.tests.nestvals.model)), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Replicates:    \t'</span>, sprintf(<span class="string">'%30i'</span>,obj.bipweb.tests.nestvals.replicates), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t NODF value:    \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.nestvals.value), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t z-score:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.nestvals.zscore), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t percent:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.nestvals.percent), <span class="string">'\n'</span>];

            str = [str, <span class="string">'NTC Nestedness\n'</span>];
            str = [str, <span class="string">'\t Null model:    \t'</span>, sprintf(<span class="string">'%30s'</span>,func2str(obj.bipweb.tests.tempvals.model)), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t Replicates:    \t'</span>, sprintf(<span class="string">'%30i'</span>,obj.bipweb.tests.tempvals.replicates), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t NODF value:    \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.tempvals.value), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t z-score:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.tempvals.zscore), <span class="string">'\n'</span>];
            str = [str, <span class="string">'\t percent:       \t'</span>, sprintf(<span class="string">'%30.4f'</span>,obj.bipweb.tests.tempvals.percent), <span class="string">'\n'</span>];

            fprintf(str);

        <span class="keyword">end</span>

    <span class="keyword">end</span>

    <span class="keyword">methods</span>(Static)

        <span class="keyword">function</span> formated_string = CREATE_FORMATED_STRING(headers,columns,delimiter)

            assert(length(headers) == length(columns));

            n_cols = length(headers);

            <span class="keyword">if</span>(nargin==2)
                delimiter = <span class="string">','</span>;
            <span class="keyword">end</span>


            formated_string = <span class="string">''</span>;
            <span class="keyword">if</span>(isa(columns,<span class="string">'double'</span>))
                columns_str = arrayfun(@num2str, columns, <span class="string">'unif'</span>, 0);
                <span class="keyword">for</span> i = 1:n_cols
                    spacing(i) = max(max(cellfun(<span class="string">'length'</span>,columns_str(:,i))),length(headers{i}));
                <span class="keyword">end</span>

                <span class="keyword">for</span> i = 1:n_cols
                    format_data = [<span class="string">'%'</span>,num2str(spacing(i)),<span class="string">'s'</span>];
                    formated_string = [formated_string, sprintf(format_data, headers{i})];
                    <span class="keyword">if</span>(i ~= n_cols)
                        formated_string = [formated_string, delimiter];
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
                formated_string = [formated_string, <span class="string">'\n'</span>];

                [n_r n_c] = size(columns_str);
                <span class="keyword">for</span> j = 1:n_r
                    <span class="keyword">for</span> i = 1:n_c
                        format_data = [<span class="string">'%'</span>,num2str(spacing(i)),<span class="string">'s'</span>];
                        formated_string = [formated_string, sprintf(format_data, columns_str{j,i})];
                        <span class="keyword">if</span>(i ~= n_cols)
                            formated_string = [formated_string, delimiter];
                        <span class="keyword">end</span>
                    <span class="keyword">end</span>
                    formated_string = [formated_string, <span class="string">'\n'</span>];
                <span class="keyword">end</span>
            <span class="keyword">end</span>


        <span class="keyword">end</span>

    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><pre class="codeoutput">Error using Printer (line 24)
Not enough input arguments.
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.13<br></p></div><!--
##### SOURCE BEGIN #####
% Printer - Class used for printing output files on screen and files.
%
% Printer Methods:
%    Printer - Main Constructor
%    CreateCytoscapeData - Create input files for Cytoscape software
%
% See also:
%    Reading
classdef Printer < handle
    
    properties
        
        bipweb = {};
        
    end
    
    methods
        
        function obj = Printer(webbip)
        % PRINTER - Main Constructor
        %   pt = Printer(webbip) Create a Printer object pt wich will be
        %   related to Bipartite object webbip.
        
            obj.bipweb = webbip;
            
        end
        
%         function obj = SpeciesLevel(obj, toscreen, tofile)
%            
%             webbip = obj.bipweb;
%             
%             aindex = webbip.name==' ';
%             namebip = webbip.name;
%             namebip(aindex) = '_';
%             
%             if(nargin == 1)
%                 toscreen = 1;
%                 tofile = 1;
%                 filename = [namebip, '_sp.txt'];
%             elseif(nargin == 2)
%                 tofile = 1;
%                 filename = [namebip, '_sp.txt'];
%             elseif (nargin == 3)
%                 filename = [namebip, '_sp.txt'];
%             end
%             
%             header = '';
%             colwitdth = 9;
%             formatstring = ['%-',num2str(colwitdth),'s'];
%             formatint = ['%-',num2str(colwitdth),'d'];
%             formatfloat = ['%-',num2str(colwitdth),'.3f'];
%             estring = 'REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH';
%             
%             header = [header, sprintf(repmat(formatstring,1,6), 'Specie','Level','Degree','SPE','SSI','RR')];
%             if(webbip.modules.done); header = [header, sprintf(repmat(formatstring,1,1), 'Module')]; end;
%             header = [header, '\n'];
%             
%             info = '';
%             for i = 1:webbip.n_rows
%                 aindex = webbip.row_labels{i}==' ';
%                 label_name = webbip.row_labels{i};
%                 label_name(aindex) = '_';
%                 info = [info, sprintf(formatstring,label_name(1:min(colwitdth,length(label_name))))];
%                 info = [info, sprintf(formatstring, 'top')];
%                 info = [info, sprintf(formatint, webbip.row_degrees(i))];
%                 info = [info, sprintf(formatfloat, webbip.specificity(i))];
%                 info = [info, sprintf(formatfloat, webbip.ssi(i))];
%                 info = [info, sprintf(formatfloat, webbip.rr(i))];
%                 if(webbip.modules.done); info = [info, sprintf(formatint, webbip.modules.row_modules(i))]; end;
%                 info = [info, '\n'];
%             end
%             
%             for i = 1:webbip.n_cols
%                 aindex = webbip.col_labels{i}==' ';
%                 label_name = webbip.col_labels{i};
%                 label_name(aindex) = '_';
%                 info = [info, sprintf(formatstring,label_name(1:min(colwitdth,length(label_name))))];
%                 info = [info, sprintf(formatstring, 'bottom')];
%                 info = [info, sprintf(formatint, webbip.col_degrees(i))];
%                 info = [info, sprintf(repmat(formatstring,1,3),estring,estring,estring)];
%                 if(webbip.modules.done); info = [info, sprintf(formatint, webbip.modules.col_modules(i))]; end;
%                 info = [info, '\n'];
%             end
%             
%             if(toscreen)
%                 fprintf(header);
%                 fprintf(info);
%             end
%             
%             if(tofile)
%                 fid = fopen([namebip,'-sp.txt'],'w');
%                 fprintf(fid,header);
%                 fprintf(fid,info);
%                 fclose(fid);
%             end
%             
%         end
%         
%         function obj = NetworkLevelSingle(obj, toscreen, tofile, filename)
%             To complete, maybe have to delete at the end of the day
%             webbip = obj.bipweb;
%             
%             if(nargin == 1)
%                 toscreen = 1;
%                 tofile = 1;
%                 filename = [webbip.name, '_networklevel.txt'];
%             elseif(nargin == 2)
%                 tofile = 1;
%                 filename = [webbip.name, '_networklevel.txt'];
%             elseif (nargin == 3)
%                 filename = [webbip.name, '_networklevel.txt'];
%             end
%             format = '%5.2f';
%             formatint = '%5d';
%             fileexist = exist(filename,'file');
%             header = '';
%             if(~fileexist)
%                 header = [header, '\nGeneral properties\n'];
%                 header = [header,   'REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH\n'];
%                 header = [header, '\tNetwork Name:      ', webbip.name,'\n'];
%                 header = [header, '\tRows:              ', num2str(webbip.n_rows,formatint),'\n'];
%                 header = [header, '\tCols:              ', num2str(webbip.n_cols,formatint),'\n'];
%                 header = [header, '\tSize:              ', num2str(webbip.size_webmatrix,formatint),'\n'];
%                 header = [header, '\tInteractions:      ', num2str(webbip.num_edges,formatint),'\n'];
%                 header = [header, '\tConnectance:       ', num2str(webbip.connectance,format),'\n'];
%                 header = [header, '\t<Specificity>:     ', num2str(mean(webbip.specificity),format),'\n'];
%                 header = [header, '\t<Res. Range.>:     ', num2str(mean(webbip.rr),format),'\n'];
%                 header = [header, '\tNODF:              ', num2str(webbip.nestedness.nodf,format),'\n'];
%                 header = [header, '\tNODF Rows:         ', num2str(webbip.nestedness.nodf_rows,format),'\n'];
%                 header = [header, '\tNODF Cols:         ', num2str(webbip.nestedness.nodf_cols,format),'\n'];                
%             end
%             
%             if(toscreen)
%                 fprintf(header);
%             end
%             
%         end
%         
%         function obj = NetworkLevel(obj, toscreen, tofile)
%             webbip = obj.bipweb;
%             filename = './networklevel.txt';
%             
%             if(nargin == 1)
%                 toscreen = 1;
%                 tofile = 1;
%             else(nargin == 2)
%                 tofile = 1;
%             end
%             
%             header = '';
%             colwitdth = 9;
%             formatstring = ['%-',num2str(colwitdth),'s'];
%             formatint = ['%-',num2str(colwitdth),'d'];
%             formatfloat = ['%-',num2str(colwitdth),'.3f'];
%             estring = 'REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH';
%             
%             header = [header, sprintf(repmat(formatstring,1,5), 'Name','Conn','Size','n_rows','n_cols')];
%             header = [header, sprintf(repmat(formatstring,1,5), 'nodf','nodf_r','nodf_c','aspe','arr')];
%             header = [header, sprintf(repmat(formatstring,1,5), 'resp','inc','mN','mQb','mQr')];
%             header = [header, sprintf(repmat(formatstring,1,6), 'n_sim','n_pval','nicLow','nicUp','n_z','nco_sim')];
%             header = [header, sprintf(repmat(formatstring,1,5), 'nco_pval','ncoicLow','ncoicUp','nco_z','nro_sim')];
%             header = [header, sprintf(repmat(formatstring,1,4), 'nro_pval','nroicLow','nroicUp','nro_z')];
%             header = [header, sprintf(repmat(formatstring,1,4), 'mQr_sim','mQr_val','mQrIclow','mQrIcup','mQr_z')];
%             header = [header, sprintf(repmat(formatstring,1,4), 'mQb_sim','mQb_val','mQbIclow','mQbIcup','mQb_z')];
%             header = [header, sprintf(repmat(formatstring,1,3), 'tReps','null_name')];
%             header = [header, '\n'];
%             header = [header, 'REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-\n'];
%             
%             [R I] = SpeFunc.IR(webbip.webmatrix);
%             aindex = webbip.name==' ';
%             namebip = webbip.name;
%             namebip(aindex) = '_';
%             info = sprintf(formatstring,namebip(1:min(colwitdth-1,length(namebip))));
%             info = [info, sprintf(formatfloat, webbip.connectance)];
%             info = [info, sprintf(formatint, webbip.size_webmatrix)];
%             info = [info, sprintf(formatint, webbip.n_rows)];
%             info = [info, sprintf(formatint, webbip.n_cols)];
%             info = [info, sprintf(formatfloat, webbip.nestedness.nodf)];
%             info = [info, sprintf(formatfloat, webbip.nestedness.nodf_rows)];
%             info = [info, sprintf(formatfloat, webbip.nestedness.nodf_cols)];
%             info = [info, sprintf(formatfloat, mean(webbip.specificity))];
%             info = [info, sprintf(formatfloat, mean(webbip.rr))];
%             info = [info, sprintf(formatfloat, R)];
%             info = [info, sprintf(formatfloat, I)];
%             
%             if(webbip.modules.done)
%                 info = [info, sprintf(formatint, webbip.modules.N)];
%                 info = [info, sprintf(formatfloat, webbip.modules.Qb)];
%                 info = [info, sprintf(formatfloat, webbip.modules.Qr)];
%             else
%                 info = [info, sprintf(repmat(formatstring,1,3),estring,estring,estring)];
%             end
%             
%             if(webbip.tests.nest_done)
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals.ci(1))];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals.p)];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals.ci(2))];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals.ci(3))];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals.zscore)];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_cols.ci(1))];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_cols.p)];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_cols.ci(2))];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_cols.ci(3))];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_cols.zscore)];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_rows.ci(1))];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_rows.p)];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_rows.ci(2))];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_rows.ci(3))];
%                 info = [info, sprintf(formatfloat, webbip.tests.nestvals_rows.zscore)];
%             else
%                 info = [info, sprintf(repmat(formatstring,1,12),estring,estring,estring,estring,estring,estring, ...
%                     estring,estring,estring,estring,estring,estring)];
%             end
%             
%             if(webbip.tests.modul_done)
%                 info = [info, sprintf(formatfloat, webbip.tests.qr_vals.ci(1))];
%                 info = [info, sprintf(formatfloat, webbip.tests.qr_vals.p)];
%                 info = [info, sprintf(formatfloat, webbip.tests.qr_vals.ci(2))];
%                 info = [info, sprintf(formatfloat, webbip.tests.qr_vals.ci(3))];
%                 info = [info, sprintf(formatfloat, webbip.tests.qr_vals.zscore)];
% 
%                 info = [info, sprintf(formatfloat, webbip.tests.qb_vals.ci(1))];
%                 info = [info, sprintf(formatfloat, webbip.tests.qb_vals.p)];
%                 info = [info, sprintf(formatfloat, webbip.tests.qb_vals.ci(2))];
%                 info = [info, sprintf(formatfloat, webbip.tests.qb_vals.ci(3))];
%                 info = [info, sprintf(formatfloat, webbip.tests.qb_vals.zscore)];
%             else
%                 info = [info, sprintf(repmat(formatstring,1,8),estring,estring,estring, ... 
%                     estring,estring,estring,estring,estring)];
%             end
%             
%             if(webbip.tests.modul_done || webbip.tests.nest_done)
%                 info = [info, sprintf(formatint, webbip.tests.replicates)];
%                 info = [info, sprintf(formatstring, func2str(webbip.tests.model))];
%             else
%                 info = [info, sprintf(repmat(formatstring,1,2),estring,estring)];
%             end
%             
%             info = [info, '\n'];
%             
%             if(toscreen)
%                 fprintf(header);
%                 fprintf(info);
%             end
%             
%             if(tofile)
%                 if(~exist(filename,'file')) 
%                     fid = fopen(filename,'w');
%                     fprintf(fid, header);
%                 else
%                     fid = fopen(filename,'a');
%                 end
%                 fprintf(fid,info);
%                 fclose(fid);
%             end
%             
%         end
        
        function obj = CreateCytoscapeData(obj,filename)
        % CreateCytoscapeData - Create input files for Cytoscape software
        %   obj = CreateCytoscapeData(obj,filename) Create two input files
        %   filename_edges.csv and filename_nodes.csv for Cytoscape
        %   software. The first one is indispensable for Cytoscape and
        %   contains the list of edges of the bipartite network. The second
        %   contain additional information of the nodes such as module id,
        %   name label, etc. This additional information can be used in
        %   Cytoscape for creating layouts with more information.
            
            n_rows = obj.bipweb.n_rows;
            n_cols = obj.bipweb.n_cols;
            
            inter = sum(sum(obj.bipweb.adjacency));
            adlist = zeros(inter,3);
            
            matrix = obj.bipweb.webmatrix;
            
            nn = 1;

            fidedges = fopen([filename,'_edges.csv'],'w');
            fidnodes = fopen([filename,'_nodes.csv'],'w');
            
            for i = 1:n_rows; fprintf(fidedges,'%i\n',i); end;
            for j = 1:n_cols; fprintf(fidedges,'%i\n',j+n_cols); end;
            
            modules_done = obj.bipweb.modules.done;
            
            row_modul = mod(find(obj.bipweb.modules.rr'==1),obj.bipweb.modules.N);
            col_modul = mod(find(obj.bipweb.modules.tt'==1),obj.bipweb.modules.N);
            row_modul = row_modul.*(row_modul>0)+(row_modul==0).*obj.bipweb.modules.N;
            col_modul = col_modul.*(col_modul>0)+(col_modul==0).*obj.bipweb.modules.N;
            
            for i = 1:n_rows
                for j = 1:n_cols
                    if(matrix(i,j) > 0)
                        if(~modules_done)
                            fprintf(fidedges,'%i %i %i\n',i,j+n_rows,matrix(i,j));
                        else
                            if(row_modul(i)==col_modul(j))
                                fprintf(fidedges,'%i %i %i %i\n',i,j+n_rows,matrix(i,j),row_modul(i));
                            else
                                fprintf(fidedges,'%i %i %i %i\n',i,j+n_rows,matrix(i,j),0);
                            end
                        end
                    end
                end
            end
            
            fclose(fidedges);
               
            fprintf(fidnodes,'ID,NAME,TYPE,MODULE\n');
            row_labels = obj.bipweb.row_labels;
            col_labels = obj.bipweb.col_labels;
            
            for i = 1:n_rows
                fprintf(fidnodes,'%i,%s,%i,%i\n',i,row_labels{i},1,row_modul(i));
            end
            for j = 1:n_cols
                fprintf(fidnodes,'%i,%s,%i,%i\n',j+n_rows,col_labels{j},2,col_modul(j));
            end
            
            fclose(fidnodes);
%                
%             for j = 1:n_cols
%                 fprintf(fidnodes,'%i %i 2\n',j+n_rows,find(tt_final{cid}(j,:)));
%             end
%             
%             for i = 1:nrows 
%                 for j = 1:n_cols
%                     if(matrix(i,j) > 0)
%                         adlist(nn,:) = [i matrix(i,j) (j+nrows)];
%                         nn = nn+1;
%                     end
%                 end
%             end
            
            %dlmwrite([filename,'.sif'], adlist, 'delimiter', ' ', 'precision', 6);
            %nodeatribs = fopen([filename,'.pvals'],'w');
            %fprintf(nodeatribs,'ID\tDEGREE\tTYPE\n');
            %for i = 1:obj.nRows
            %    fprintf(nodeatribs,'%i\t%i\t%i\n',i,sum(obj.Matrix(i,:)), 1);
            %end
            %for i = 1:obj.nCols
            %    fprintf(nodeatribs,'%i\t%i\t%i\n',i+obj.nRows,sum(obj.Matrix(:,i)), 2);
            %end
        end
        
        function PrintBasicResults(obj)
            fprintf('Modularity: ');
        end
       
        
    end
    
    methods
       
        function PrintGeneralProperties(obj,filename)
            
            str = 'General Properties\n';
            str = [str, '\t Number of species:       \t', sprintf('%6i',obj.bipweb.n_rows+obj.bipweb.n_cols), '\n'];
            str = [str, '\t Number of row species:   \t', sprintf('%6i',obj.bipweb.n_rows), '\n'];
            str = [str, '\t Number of column species:\t', sprintf('%6i',obj.bipweb.n_cols), '\n'];
            str = [str, '\t Number of Interactions:  \t', sprintf('%6i',obj.bipweb.num_edges), '\n'];
            str = [str, '\t Size:                    \t', sprintf('%6i',obj.bipweb.size_webmatrix), '\n'];
            str = [str, '\t Connectance or fill:     \t', sprintf('%6.3f',obj.bipweb.connectance), '\n'];
            
            fprintf(str);    
            
        end
        
        function PrintStructureValues(obj,filename)
           
            if(obj.bipweb.modules.done == 0)
                obj.bipweb.modules.Detect();
            end
            
            if(obj.bipweb.ntc.done == 0)
                obj.bipweb.ntc.CalculateNestedness;
            end
            
            str = 'Modularity\n';
            str = [str, '\t Used algorithm:             \t', sprintf('%16s',class(obj.bipweb.modules)), '\n'];
            str = [str, '\t N (Number of modules):      \t', sprintf('%16i',obj.bipweb.modules.N), '\n'];
            str = [str, '\t Qb (Standard metric):       \t', sprintf('%16.4f',obj.bipweb.modules.Qb), '\n'];
            str = [str, '\t Qr (Ratio of int/ext inter):\t', sprintf('%16.4f',obj.bipweb.modules.Qr), '\n'];
            
            str = [str, 'Nestedness\n'];
            str = [str, '\tNODF metric value:           \t', sprintf('%16.4f',obj.bipweb.nodf.nodf), '\n'];
            str = [str, '\tNTC metric value:            \t', sprintf('%16.4f',obj.bipweb.ntc.N), '\n'];
           
            fprintf(str);  
            
        end
        
        function PrintStructureStatistics(obj,filename)
           
            if(obj.bipweb.tests.modul_done == 0)
                obj.bipweb.tests.Modularity();
            end
            
            if(obj.bipweb.tests.nest_done == 0)
                obj.bipweb.tests.Nestedness();
            end
            
            if(obj.bipweb.tests.temp_done == 0)
                obj.bipweb.tests.Temperature();
            end
            
            str = 'Modularity\n';
            str = [str, '\t Used algorithm:\t', sprintf('%30s',obj.bipweb.tests.qb_vals.algorithm), '\n'];
            str = [str, '\t Null model:    \t', sprintf('%30s',func2str(obj.bipweb.tests.qb_vals.model)), '\n'];
            str = [str, '\t Replicates:    \t', sprintf('%30i',obj.bipweb.tests.qb_vals.replicates), '\n'];
            str = [str, '\t Qb value:      \t', sprintf('%30.4f',obj.bipweb.tests.qb_vals.value), '\n'];
            str = [str, '\t z-score:       \t', sprintf('%30.4f',obj.bipweb.tests.qb_vals.zscore), '\n'];
            str = [str, '\t percent:       \t', sprintf('%30.4f',obj.bipweb.tests.qb_vals.percent), '\n'];
            
            str = [str, 'NODF Nestedness\n'];
            str = [str, '\t Null model:    \t', sprintf('%30s',func2str(obj.bipweb.tests.nestvals.model)), '\n'];
            str = [str, '\t Replicates:    \t', sprintf('%30i',obj.bipweb.tests.nestvals.replicates), '\n'];
            str = [str, '\t NODF value:    \t', sprintf('%30.4f',obj.bipweb.tests.nestvals.value), '\n'];
            str = [str, '\t z-score:       \t', sprintf('%30.4f',obj.bipweb.tests.nestvals.zscore), '\n'];
            str = [str, '\t percent:       \t', sprintf('%30.4f',obj.bipweb.tests.nestvals.percent), '\n'];
            
            str = [str, 'NTC Nestedness\n'];
            str = [str, '\t Null model:    \t', sprintf('%30s',func2str(obj.bipweb.tests.tempvals.model)), '\n'];
            str = [str, '\t Replicates:    \t', sprintf('%30i',obj.bipweb.tests.tempvals.replicates), '\n'];
            str = [str, '\t NODF value:    \t', sprintf('%30.4f',obj.bipweb.tests.tempvals.value), '\n'];
            str = [str, '\t z-score:       \t', sprintf('%30.4f',obj.bipweb.tests.tempvals.zscore), '\n'];
            str = [str, '\t percent:       \t', sprintf('%30.4f',obj.bipweb.tests.tempvals.percent), '\n'];

            fprintf(str);  
            
        end
        
        function PrintStructureStatisticsOfModules(obj,filename)
           
            if(obj.bipweb.tests.modul_done == 0)
                obj.bipweb.tests.Modularity();
            end
            
            if(obj.bipweb.tests.nest_done == 0)
                obj.bipweb.tests.Nestedness();
            end
            
            if(obj.bipweb.tests.temp_done == 0)
                obj.bipweb.tests.Temperature();
            end
            
            %             fprintf('Module \t Modularity \t zscore \t percent \t NODF \t zscore \t percent \t NTC \t zscore \t percet \n');
%             for net = obj.module_networks
%                 if(isempty(net{1}.webmatrix))
%                     continue;
%                 end
%                 fprintf('%i \t %f \t %f \t %f \t %f \t %f \t %f \t %f \t %f \t %f \n', ...
%                 i, ...
%                 net{1}.tests.qb_vals.Qb, net{1}.tests.qb_vals.zscore, net{1}.tests.qb_vals.percent, ...
%                 net{1}.tests.nestvals.nodf, net{1}.tests.nestvals.zscore, net{1}.tests.nestvals.percent, ...
%                 net{1}.tests.tempvals.ntc, net{1}.tests.tempvals.zscore, net{1}.tests.tempvals.percent);
%             
%                 i = i+1;
%             end
            
            str = 'Modularity\n';
            str = [str, '\t Used algorithm:\t', sprintf('%30s',obj.bipweb.tests.qb_vals.algorithm), '\n'];
            str = [str, '\t Null model:    \t', sprintf('%30s',func2str(obj.bipweb.tests.qb_vals.model)), '\n'];
            str = [str, '\t Replicates:    \t', sprintf('%30i',obj.bipweb.tests.qb_vals.replicates), '\n'];
            str = [str, '\t Qb value:      \t', sprintf('%30.4f',obj.bipweb.tests.qb_vals.value), '\n'];
            str = [str, '\t z-score:       \t', sprintf('%30.4f',obj.bipweb.tests.qb_vals.zscore), '\n'];
            str = [str, '\t percent:       \t', sprintf('%30.4f',obj.bipweb.tests.qb_vals.percent), '\n'];
            
            str = [str, 'NODF Nestedness\n'];
            str = [str, '\t Null model:    \t', sprintf('%30s',func2str(obj.bipweb.tests.nestvals.model)), '\n'];
            str = [str, '\t Replicates:    \t', sprintf('%30i',obj.bipweb.tests.nestvals.replicates), '\n'];
            str = [str, '\t NODF value:    \t', sprintf('%30.4f',obj.bipweb.tests.nestvals.value), '\n'];
            str = [str, '\t z-score:       \t', sprintf('%30.4f',obj.bipweb.tests.nestvals.zscore), '\n'];
            str = [str, '\t percent:       \t', sprintf('%30.4f',obj.bipweb.tests.nestvals.percent), '\n'];
            
            str = [str, 'NTC Nestedness\n'];
            str = [str, '\t Null model:    \t', sprintf('%30s',func2str(obj.bipweb.tests.tempvals.model)), '\n'];
            str = [str, '\t Replicates:    \t', sprintf('%30i',obj.bipweb.tests.tempvals.replicates), '\n'];
            str = [str, '\t NODF value:    \t', sprintf('%30.4f',obj.bipweb.tests.tempvals.value), '\n'];
            str = [str, '\t z-score:       \t', sprintf('%30.4f',obj.bipweb.tests.tempvals.zscore), '\n'];
            str = [str, '\t percent:       \t', sprintf('%30.4f',obj.bipweb.tests.tempvals.percent), '\n'];

            fprintf(str);  
            
        end
        
    end
    
    methods(Static)
        
        function formated_string = CREATE_FORMATED_STRING(headers,columns,delimiter)
           
            assert(length(headers) == length(columns));
            
            n_cols = length(headers);
            
            if(nargin==2)
                delimiter = ',';
            end
            
            
            formated_string = '';
            if(isa(columns,'double'))
                columns_str = arrayfun(@num2str, columns, 'unif', 0);
                for i = 1:n_cols
                    spacing(i) = max(max(cellfun('length',columns_str(:,i))),length(headers{i}));
                end
                
                for i = 1:n_cols
                    format_data = ['%',num2str(spacing(i)),'s'];
                    formated_string = [formated_string, sprintf(format_data, headers{i})];
                    if(i ~= n_cols)
                        formated_string = [formated_string, delimiter];
                    end
                end
                formated_string = [formated_string, '\n'];
                
                [n_r n_c] = size(columns_str);
                for j = 1:n_r
                    for i = 1:n_c
                        format_data = ['%',num2str(spacing(i)),'s'];
                        formated_string = [formated_string, sprintf(format_data, columns_str{j,i})];
                        if(i ~= n_cols)
                            formated_string = [formated_string, delimiter];
                        end
                    end
                    formated_string = [formated_string, '\n'];
                end
            end
            
            
        end
        
    end
    
end
##### SOURCE END #####
--></body></html>